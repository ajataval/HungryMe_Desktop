<!DOCTYPE html>
<html>
<head>
    <title>Hotel Menu Update Page</title>
    <link rel="stylesheet" href="stylesheets/visuals2.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
        var orlen;
        var jobj;
        var user;
        var counter = 0;
        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }
        function checkCookie() {
            user=getCookie("username");
            if (user != "") {
                //alert("Welcome again " + user);
                $.ajax({
                    type: "GET",
                    url: "/hotel/users/"+user+"/menu",
                    contentType: "application/json"
                }).done(function (obj) {
                    jobj=obj;
                    updateAcc();
                }).fail(function (obj) {
                    alert("Failed");
                });
            } else {
                user = prompt("Please enter your name:","");
                if (user != "" && user != null) {
                    setCookie("username", user, 30);
                }
            }
        }
        function updateAcc() {
            orlen = jobj.menu.length;
            console.log(jobj);
            var name;
            for(var temp = 1; temp <= orlen; temp++){
                name = jobj.menu[temp-1].name;
                var comm="";

                for(var temp2 = 1; temp2 <= jobj.menu[temp-1].comments.length; temp2++){
                    comm+="\""+jobj.menu[temp-1].comments[temp2-1]+ "\"\n";
                }
                var accord="";
                accord+="<h3>" + name + "</h3><div><p>" + comm + "</p></div>";
                $('#accordion').append(accord);
            }
            $( "#accordion" ).accordion();

        };

    </script>
</head>

<body onload="checkCookie()">
<div class="banner">
    <img style="width: 95%" class ="picstyle" src="images/banner4.png" >
</div>
<br/>
<p class = "genwebsitetext">Restaurant Reviews and Comments</p>
<br/>

<div data-role="content" id="Div1">
    <div id="accordion" data-role="collapsible-set"/>
</div>

</body>
</html>